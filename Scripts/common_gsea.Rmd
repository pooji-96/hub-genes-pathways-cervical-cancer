---
author: "Dillen Wischmeier"
date: "2025-04-24"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Common GSEA Gene Sets

## Data Import

```{r}
library(dplyr)
```

```{r, message=FALSE}
# load the tsv file for each comparison from GSEA for each dataset
# gse63514
cin_n_63514  <- readr::read_tsv("./GSEA/GSE63514/<analysis_folder>/gsea_report_for_CIN_<numeric-ID>.tsv") |> 
  janitor::clean_names()
cc_cin_63514 <- readr::read_tsv("./GSEA/GSE63514/<analysis_folder>/gsea_report_for_CC_<numeric-ID>.tsv") |> 
  janitor::clean_names()
cc_n_63514   <- readr::read_tsv("./GSEA/GSE63514/<analysis_folder>/gsea_report_for_CC_<numeric-ID>.tsv") |> 
  janitor::clean_names()

# gse64217
cin_n_64217  <- readr::read_tsv("./GSEA/GSE64217/<analysis_folder>/gsea_report_for_CIN_<numeric-ID>.tsv") |> 
  janitor::clean_names()
cc_cin_64217 <- readr::read_tsv("./GSEA/GSE64217/<analysis_folder>/gsea_report_for_CC_<numeric-ID>.tsv") |> 
  janitor::clean_names()
cc_n_64217   <- readr::read_tsv("./GSEA/GSE64217/<analysis_folder>/gsea_report_for_CC_<numeric-ID>.tsv") |> 
  janitor::clean_names()

# gse138080
cin_n_138080  <- readr::read_tsv("./GSEA/GSE138080/<analysis_folder>/gsea_report_for_CIN_<numeric-ID>.tsv") |> 
  janitor::clean_names()
cc_cin_138080 <- readr::read_tsv("./GSEA/GSE138080/<analysis_folder>/gsea_report_for_CC_<numeric-ID>.tsv") |> 
  janitor::clean_names()
cc_n_138080   <- readr::read_tsv("./GSEA/GSE138080/<analysis_folder>/gsea_report_for_CC_<numeric-ID>.tsv") |> 
  janitor::clean_names()
```

## Filter for Significant Gene Sets

```{r}
cin_n_63514_names <- cin_n_63514 |> 
  filter(nom_p_val < 0.01) |> 
  pull(name)

cin_n_64217_names <- cin_n_64217 |> 
  filter(nom_p_val < 0.01) |> 
  pull(name)

cin_n_138080_names <- cin_n_138080 |> 
  filter(nom_p_val < 0.01) |> 
  pull(name)
```

```{r}
cc_cin_63514_names <- cc_cin_63514 |> 
  filter(nom_p_val < 0.01) |> 
  pull(name)

cc_cin_64217_names <- cc_cin_64217 |> 
  filter(nom_p_val < 0.01) |> 
  pull(name)

cc_cin_138080_names <- cc_cin_138080 |> 
  filter(nom_p_val < 0.01) |> 
  pull(name)
```

```{r}
cc_n_63514_names <- cc_n_63514 |> 
  filter(nom_p_val < 0.01) |> 
  pull(name)

cc_n_64217_names <- cc_n_64217 |> 
  filter(nom_p_val < 0.01) |> 
  pull(name)

cc_n_138080_names <- cc_n_138080 |> 
  filter(nom_p_val < 0.01) |> 
  pull(name)
```

## Extract Common Gene Sets

### Original Settings

The original paper reported common gene sets as significant pathways of p-val \< 0.01 at the intersection of all 3 data sets for each group of contrasts: N-CIN, CIN-CC, and N-CC. The most significant pathway was then reported for each group by adding an additional FDR threshold of \< 0.05.

#### Common Gene Sets

```{r}
# CIN-N
intersect_cin_n <- Reduce(intersect, list(cin_n_63514_names, cin_n_64217_names, cin_n_138080_names))

noquote(intersect_cin_n)
```

```{r}
# CC-CIN
intersect_cc_cin <- Reduce(intersect, list(cc_cin_63514_names, cc_cin_64217_names, cc_cin_138080_names))

noquote(intersect_cc_cin)
```

```{r}
# CC-N
intersect_cc_n <- Reduce(intersect, list(cc_n_63514_names, cc_n_64217_names, cc_n_138080_names))

noquote(intersect_cc_n)
```

#### Most Significant Gene Sets

Of the single common gene set found in the CC-N group, an FDR of \< 0.05 was found in only 1 of the 3 data sets.

### Our Settings

Since the original thresholds yield very little, we've relaxed the original criteria to the intersection of any 2 data sets using the same p-value, 0.01. Report genes common to the intersection of any 2 datasets using p \< 0.01 for each group of contrasts: N-CIN, CIN-CC, and N-CC. Do not replicate top pathways via FDR threshold.

#### Common Gene Sets

```{r}
# CIN-N
cin_n_63514_names2 <- cin_n_63514 |> 
  filter(nom_p_val < 0.05) |> 
  pull(name)

cin_n_64217_names2 <- cin_n_64217 |> 
  filter(nom_p_val < 0.05) |> 
  pull(name)

cin_n_138080_names2 <- cin_n_138080 |> 
  filter(nom_p_val < 0.05) |> 
  pull(name)

intersect2_cin_n <- intersect(cin_n_138080_names2, cin_n_64217_names2) |> 
  append(intersect(cin_n_63514_names2, cin_n_64217_names2)) |> 
  append(intersect(cin_n_138080_names2, cin_n_63514_names2)) |> 
  unique()

noquote(intersect2_cin_n)
```

```{r}
# CC-CIN
cc_cin_63514_names2 <- cc_cin_63514 |> 
  filter(nom_p_val < 0.05) |> 
  pull(name)

cc_cin_64217_names2 <- cc_cin_64217 |> 
  filter(nom_p_val < 0.05) |> 
  pull(name)

cc_cin_138080_names2 <- cc_cin_138080 |> 
  filter(nom_p_val < 0.05) |> 
  pull(name)

intersect2_cc_cin <- intersect(cc_cin_138080_names2, cc_cin_64217_names2) |> 
  append(intersect(cc_cin_63514_names2, cc_cin_64217_names2)) |> 
  append(intersect(cc_cin_138080_names2, cc_cin_63514_names2)) |> 
  unique()

noquote(intersect2_cc_cin)
```

```{r}
# CC-N
cc_n_63514_names2 <- cc_n_63514 |> 
  filter(nom_p_val < 0.05) |> 
  pull(name)

cc_n_64217_names2 <- cc_n_64217 |> 
  filter(nom_p_val < 0.05) |> 
  pull(name)

cc_n_138080_names2 <- cc_n_138080 |> 
  filter(nom_p_val < 0.05) |> 
  pull(name)

intersect2_cc_n <- intersect(cc_n_138080_names2, cc_n_64217_names2) |>
    append(intersect(cc_n_63514_names2, cc_n_64217_names2)) |> 
    append(intersect(cc_n_138080_names2, cc_n_63514_names2)) |> 
    unique()

noquote(intersect2_cc_n)
```

```{r}
sessionInfo()
```
